<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù¾Ù†Ù„ Ú©Ø§Ù†ÙÛŒÚ¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>

<style>
body{
    font-family:tahoma;
    background:#0b132b;
    color:white;
    text-align:center;
    margin:0;
    transition:0.3s;
}

body.light{
    background:#f5f5f5;
    color:#111;
}

h1{margin:20px;}

input{
    width:85%;
    padding:12px;
    border-radius:10px;
    border:none;
    margin:10px;
}

button{
    width:90%;
    padding:15px;
    margin:10px;
    border:none;
    border-radius:10px;
    background:#3a86ff;
    color:white;
    cursor:pointer;
}

button:hover{
    opacity:0.85;
    transform:scale(1.03);
    transition:0.2s;
}

.toggle-theme{
    width:auto;
    padding:8px 15px;
    background:#222;
}

.guide-btn{
    background:#ffbe0b;
    color:black;
}

.guide{
    background:#14213d;
    margin:0 15px;
    border-radius:15px;
    text-align:right;
    line-height:2;
    max-height:0;
    overflow:hidden;
    transition:0.4s;
}

.guide.open{
    padding:15px;
    max-height:500px;
}

.box{
    background:#1c2541;
    margin:10px;
    padding:15px;
    border-radius:15px;
}

body.light .box{background:#fff;}

.config{
    background:#0f1b3d;
    margin:8px 0;
    padding:10px;
    border-radius:10px;
    font-size:12px;
    word-break:break-all;
}

body.light .config{background:#eee;}

.copy{
    margin-top:5px;
    background:#8338ec;
    padding:6px;
    border-radius:6px;
    font-size:12px;
}

.sub{background:#06d6a0;}

.telegram-btn{
    display:block;
    width:85%;
    margin:30px auto;
    padding:15px;
    border-radius:12px;
    background:#229ED9;
    color:white;
    text-decoration:none;
}
</style>
</head>

<body>

<h1>ğŸŒ Ù¾Ù†Ù„ Ú©Ø§Ù†ÙÛŒÚ¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</h1>

<button class="toggle-theme" onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>

<button class="guide-btn" onclick="toggleGuide()">ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§</button>

<div id="guideBox" class="guide">
ğŸ“˜ Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:<br><br>

1ï¸âƒ£ Ø±ÙˆÛŒ "Ø¢Ù¾Ø¯ÛŒØª" Ø¨Ø²Ù† ØªØ§ Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ Ø¯Ø±ÛŒØ§ÙØª Ø´ÙˆØ¯<br><br>

2ï¸âƒ£ Ú©Ø´ÙˆØ± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± (ğŸ‡ºğŸ‡¸ Ø¢Ù…Ø±ÛŒÚ©Ø§ ÛŒØ§ ğŸ‡©ğŸ‡ª Ø¢Ù„Ù…Ø§Ù†) Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†<br><br>

3ï¸âƒ£ Ø±ÙˆÛŒ "ğŸ“‚ Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§" Ø¨Ø²Ù†<br><br>

4ï¸âƒ£ ÛŒÚ©ÛŒ Ø§Ø² Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ù†<br><br>

5ï¸âƒ£ ÙˆØ§Ø±Ø¯ ÛŒÚ©ÛŒ Ø§Ø² Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ Ø´Ùˆ Ùˆ Import Ú©Ù†:<br>
- V2RayNG (Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯)<br>
- V2RayN (ÙˆÛŒÙ†Ø¯ÙˆØ²)<br>
- Streisand (Ø¢ÛŒÙÙˆÙ†)<br><br>

6ï¸âƒ£ ÛŒØ§ Ø±ÙˆÛŒ "ğŸ“¡ Ø³Ø§Ø¨Ø³Ú©Ø±ÛŒÙ¾Ø´Ù†" Ø¨Ø²Ù† ØªØ§ Ù‡Ù…Ù‡ Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ ÛŒÚ©Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯<br><br>

âš¡ Ø§Ú¯Ø± ÙˆØµÙ„ Ù†Ø´Ø¯ØŒ Ú†Ù†Ø¯ Ú©Ø§Ù†ÙÛŒÚ¯ Ù…Ø®ØªÙ„Ù ØªØ³Øª Ú©Ù†
</div>

<input type="text" id="search" placeholder="ğŸ” Ø¬Ø³ØªØ¬Ùˆ..." oninput="searchData()">

<button onclick="loadConfigs()">ğŸ”„ Ø¢Ù¾Ø¯ÛŒØª</button>

<p id="lastUpdate">â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...</p>

<div id="countries">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...</div>

<a class="telegram-btn" href="https://t.me/V2raying_config" target="_blank">
ğŸš€ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„
</a>

<script>
let data = [];
let originalData = [];
let lastUpdateTime = null;

function toggleTheme(){
    document.body.classList.toggle("light");
}

function toggleGuide(){
    document.getElementById("guideBox").classList.toggle("open");
}

async function loadConfigs(){
    document.getElementById("countries").innerHTML="â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...";

    try{
        const res = await fetch("https://raw.githubusercontent.com/mahdibland/V2RayAggregator/master/sub/sub_merge.txt?" + Date.now());

        lastUpdateTime = new Date();
        updateClock();

        const text = await res.text();
        const lines = text.split("\n");

        let usa = [];
        let germany = [];

        lines.forEach(line=>{
            const l = line.toLowerCase();

            if(l.includes("us")) usa.push(line);
            if(l.includes("de")) germany.push(line);
        });

        data = [
            {name:"ğŸ‡ºğŸ‡¸ Ø¢Ù…Ø±ÛŒÚ©Ø§", configs: usa.slice(0,20)},
            {name:"ğŸ‡©ğŸ‡ª Ø¢Ù„Ù…Ø§Ù†", configs: germany.slice(0,20)}
        ];

        originalData = JSON.parse(JSON.stringify(data));
        showCountries();

    }catch(e){
        document.getElementById("countries").innerHTML="âŒ Ø®Ø·Ø§";
    }
}

setInterval(updateClock,60000);

function updateClock(){
    const el = document.getElementById("lastUpdate");

    if(!lastUpdateTime){
        el.innerText="â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...";
        return;
    }

    const now = new Date();
    const diff = Math.floor((now - lastUpdateTime)/1000);

    let t="";

    if(diff < 10){
        t = "Ú†Ù†Ø¯ Ù„Ø­Ø¸Ù‡ Ù¾ÛŒØ´";
    }else if(diff < 60){
        t = diff + " Ø«Ø§Ù†ÛŒÙ‡ Ù¾ÛŒØ´";
    }else if(diff < 3600){
        t = Math.floor(diff/60) + " Ø¯Ù‚ÛŒÙ‚Ù‡ Ù¾ÛŒØ´";
    }else{
        t = Math.floor(diff/3600) + " Ø³Ø§Ø¹Øª Ù¾ÛŒØ´";
    }

    el.innerText = "ğŸ•’ Ø¢Ø®Ø±ÛŒÙ† Ø¢Ù¾Ø¯ÛŒØª: " + t;
}

function showCountries(){
    let html="";

    data.forEach((c,i)=>{
        html+=`
        <div class="box">
            <h3>${c.name} (${c.configs.length})</h3>

            <button onclick="toggleConfigs(${i})">ğŸ“‚ Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§</button>
            <button class="sub" onclick="copySub(${i})">ğŸ“¡ Ø³Ø§Ø¨Ø³Ú©Ø±ÛŒÙ¾Ø´Ù†</button>

            <div id="list${i}"></div>
        </div>
        `;
    });

    document.getElementById("countries").innerHTML=html;
}

function toggleConfigs(i){
    let el=document.getElementById("list"+i);

    if(el.innerHTML!=""){
        el.innerHTML="";
        return;
    }

    let html="";
    data[i].configs.forEach(c=>{
        html+=`
        <div class="config">
        ${c}
        <button class="copy" onclick="copyConfig('${c}')">Ú©Ù¾ÛŒ</button>
        </div>`;
    });

    el.innerHTML=html;
}

function copyConfig(t){
    navigator.clipboard.writeText(t);
    alert("Ú©Ù¾ÛŒ Ø´Ø¯");
}

function copySub(i){
    navigator.clipboard.writeText(data[i].configs.join("\n"));
    alert("Ú©Ù¾ÛŒ Ø´Ø¯");
}

function searchData(){
    let v=document.getElementById("search").value.toLowerCase();

    if(!v){
        data=JSON.parse(JSON.stringify(originalData));
        showCountries();
        return;
    }

    data=originalData.map(c=>{
        if(c.name.toLowerCase().includes(v)) return c;

        return{
            name:c.name,
            configs:c.configs.filter(x=>x.toLowerCase().includes(v))
        };
    });

    showCountries();
}

setInterval(loadConfigs,1800000);
loadConfigs();
</script>

</body>
</html>
